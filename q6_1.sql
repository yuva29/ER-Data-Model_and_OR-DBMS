SELECT Villas.villa_id, Villas.name AS Villa_Name, Subscribers.user_id AS Owner_Id, Subscribers.firstname AS Owner_Firstname, Subscribers.lastname AS Owner_Lastname, avg_rating FROM Villas, Subscribers, (SELECT owner_id, Villa_Owners.villa_id, avg_rating FROM Villa_Owners, (SELECT villa_id, AVG(rating) AS avg_rating, DENSE_RANK()OVER(ORDER BY AVG(rating) DESC) AS rank FROM Review GROUP BY villa_id)Rating WHERE rank<=3 AND Villa_Owners.villa_id = Rating.villa_id)Owners WHERE Villas.villa_id = Owners.villa_id AND Subscribers.user_id = Owners.owner_id
/